import{_ as u,M as f,r as h,o as m,c as g,a as s,n,t as l,w as d,b as p,d as _,e as M}from"./config.cc8f100c.js";const x={name:"IntegrationConnect",components:{Modal:f},props:{connected:{type:Boolean}},data(){return{statusText:"",showModal:!1,error:!1,errorMessage:"",loading:!1}},computed:{statusClass(){return this.statusText==="Error"?"off":this.statusText==="Connected"?"on":""}},created(){this.statusText=this.connected?"Connected":"Not connected"},methods:{getFormInputs(){let t=[],e=document.getElementById("main-form");return e||(e=document.getElementById("main")),e&&(t=e.querySelectorAll("input, select, textarea")),t},serializeForm(){const t={};return this.getFormInputs().forEach(e=>{const a=e.getAttribute("name");t[a]=e.value}),t},refresh(){this.showModal=!1,this.error=!1,this.errorMessage="",this.loading=!0,this.statusText="Connecting...";const t=this.serializeForm();Craft.sendActionRequest("POST","formie/integrations/check-connection",{data:t}).then(e=>{if(this.loading=!1,e.data.message){this.error=!0,this.showModal=!0,this.errorMessage=Craft.t("formie","An error occurred."),this.errorMessage+=`<br><br><code>${e.data.message}</code>`,this.statusText="Error";return}this.statusText="Connected"}).catch(e=>{this.loading=!1,this.error=!0,this.showModal=!0,this.errorMessage=e,e.response.data.message&&(this.errorMessage+=`<br><br><code>${e.response.data.message}</code>`),this.statusText="Error"})},closeModal(){this.showModal=!1}}},w={class:"field lightswitch-field"},C={class:"heading"},b={class:"input ltr"},v=["title"],y={class:"fui-error-pane error"},T={class:"fui-error-content"},k=s("span",{"data-icon":"alert"},null,-1),E=["innerHTML"];function I(t,e,a,V,r,o){const c=h("modal");return m(),g("div",w,[s("div",C,[s("span",{class:n(["status",o.statusClass])},null,2),s("span",null,l(t.t("formie",r.statusText)),1)]),s("div",b,[s("button",{class:n(["btn small",{"fui-loading fui-loading-tiny":r.loading}]),title:t.t("formie","Refresh"),onClick:e[0]||(e[0]=d((...i)=>o.refresh&&o.refresh(...i),["prevent"]))},l(t.t("formie","Refresh")),11,v),p(c,{ref:"modal",modelValue:r.showModal,"onUpdate:modelValue":e[2]||(e[2]=i=>r.showModal=i),"show-header":!1,"show-footer":!1,"modal-class":"fui-integration-error-modal",onClickOutside:o.closeModal},{body:_(()=>[s("div",{class:"fui-dialog-close",onClick:e[1]||(e[1]=d((...i)=>o.closeModal&&o.closeModal(...i),["prevent"]))}),s("div",y,[s("div",T,[k,s("span",{class:"error",innerHTML:r.errorMessage},null,8,E)])])]),_:1},8,["modelValue","onClickOutside"])])])}var z=u(x,[["render",I]]);const B=M({delimiters:["${","}"],components:{IntegrationConnect:z}});B.mount(".fui-integrations-settings #details .meta");$(document).ready(()=>{document.dispatchEvent(new CustomEvent("vite-script-loaded",{detail:{path:"src/js/formie-integration-settings.js"}}))});
//# sourceMappingURL=formie-integration-settings.9e326529.js.map
